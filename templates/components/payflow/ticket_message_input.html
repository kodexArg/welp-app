<article class="ticket-input-message">
    <div class="ticket-response-form">
        <form method="post" enctype="multipart/form-data" action="{{ form_action }}">
            {% csrf_token %}
            {% if hidden_fields %}
                {% for field_name, field_value in hidden_fields.items %}
                    <input type="hidden" name="{{ field_name }}" value="{{ field_value }}">
                {% endfor %}
            {% endif %}

            {% for field in form_fields %}
                {% if field.field_type == 'textarea' %}
                <div class="form-group">
                    <label for="{{ field.id }}" class="form-label">{{ field.label }}:</label>
                    <textarea id="{{ field.id }}" name="{{ field.name }}" class="form-input" rows="4" placeholder="{{ field.placeholder }}" {% if field.required %}required{% endif %}></textarea>
                </div>
                {% elif field.field_type == 'file' %}
                <details class="attachment-details">
                    <summary class="attachment-summary">
                        <i class="fa-solid fa-paperclip text-xs mr-2"></i>
                        <span class="text-sm text-forest-600">Agregar adjuntos...</span>
                    </summary>
                    
                    <div class="attachment-content">
                        <div id="attachments-container">
                            <div class="attachment-input-row">
                                <input type="file" name="attachments" class="form-input attachment-input" accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.gif">
                                
                            <button type="button" class="button-minimal add-attachment">+</button></div>
                        </div>
                        <p class="form-help">Máximo 50MB por archivo. Formatos: PDF, DOC, XLS, imágenes</p>
                    </div>
                </details>
                {% endif %}
            {% endfor %}
            
            <div class="ticket-response-actions flex justify-end gap-3 pt-4">
                {% if cancel_url %}
                <a href="{{ cancel_url }}" class="response-action-cancel">
                    <i class="response-action-icon-cancel"></i>
                    <span>{{ cancel_text|upper }}</span>
                </a>
                {% endif %}
                <button type="submit" class="response-action-submit">
                    <i class="{{ icon_class }} response-action-icon-submit mr-2"></i>
                    <span class="font-normal capitalize">{{ button_text }}</span>
                </button>
            </div>
        </form>
    </div>
</article>