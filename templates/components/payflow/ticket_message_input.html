<div class="ticket-detail-response-section rounded-2xl border border-forest-200 bg-white shadow-inner p-6 mt-3 mb-3">
    <div class="ticket-response-form">
        <form method="post" enctype="multipart/form-data" action="{{ form_action }}">
            {% csrf_token %}
            
            {% if not hidden_fields.status %}
                <input type="hidden" name="status" value="feedback">
            {% endif %}
            
            {% for field_name, field_value in hidden_fields.items %}
                <input type="hidden" name="{{ field_name }}" value="{{ field_value }}">
            {% endfor %}
            
            {% if show_comment_box %}
                <div class="form-group">
                    <label for="id_response_body" class="form-label">{{ comment_label }}:</label>
                    <textarea 
                        id="id_response_body" 
                        name="{{ comment_field_name }}" 
                        class="form-input"
                        rows="4"
                        placeholder="{{ comment_placeholder }}"
                        {% if field_required %}required{% endif %}
                    ></textarea>
                </div>
                
                {% if show_attachments %}
                <details class="attachment-details">
                    <summary class="attachment-summary">
                        <i class="fa-solid fa-paperclip text-xs mr-2"></i>
                        <span class="text-sm text-forest-600">Agregar adjuntos...</span>
                    </summary>
                    
                    <div class="attachment-content">
                        <div id="attachments-container">
                            <div class="attachment-input-row">
                                <input 
                                    type="file" 
                                    name="attachments" 
                                    class="form-input attachment-input"
                                    accept=".pdf,.doc,.docx,.xls,.xlsx,.png,.jpg,.jpeg,.gif"
                                >
                                <button type="button" class="button-minimal add-attachment">+</button>
                            </div>
                        </div>
                        <p class="form-help">Máximo 50MB por archivo. Formatos: PDF, DOC, XLS, imágenes</p>
                    </div>
                </details>
                {% endif %}
            {% else %}
                <div class="confirmation-message py-2">
                    <p class="text-base text-primary">{{ confirmation_message }}</p>
                </div>
            {% endif %}
            
            <div class="ticket-response-actions flex justify-end gap-3 pt-4">
                {% if cancel_url %}
                <a href="{{ cancel_url }}" class="response-action-cancel">
                    <i class="response-action-icon-cancel"></i>
                    <span>{{ cancel_text|default:"Cancelar"|upper }}</span>
                </a>
                {% endif %}
                <button type="submit" class="response-action-submit">
                    <i class="{{ icon_class }} response-action-icon-submit mr-2"></i>
                    <span class="font-normal capitalize">{{ button_text|default:"Enviar" }}</span>
                </button>
            </div>
        </form>
    </div>
</div>