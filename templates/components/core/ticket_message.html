{% load format_tags %}
<div class="ticket-message">
    <span class="ticket-message-meta">
        {% if message.status == 'open' %}Abierto{% elif message.status == 'feedback' %}Comentado{% elif message.status == 'solved' %}Resuelto{% elif message.status == 'authorized' %}Autorizado{% elif message.status == 'rejected' %}Rechazado{% elif message.status == 'closed' %}Cerrado{% else %}{{ message.status|title }}{% endif %} por
        <i class="ticket-user-icon"></i>
        {% if message.user %}
            {{ message.user.first_name }} {{ message.user.last_name }}
        {% else %}
            Usuario eliminado
        {% endif %}
    </span>
    <div class="ticket-message-body">
        {% if message.body %}
            {{ message.body }}
        {% else %}
            (Sin contenido)
        {% endif %}
        <span class="ticket-message-date">
            {{ message.created_on|relative_date }}
        </span>
    </div>
    {% if message.attachments.exists %}
        <div class="ticket-attachments">
            <strong>ðŸ“Ž ADJUNTOS:</strong>
            {% for attachment in message.attachments.all %}
                <div class="ticket-attachment">
                    <span class="tag tag-category">{{ attachment.get_attachment_type_display }}</span>
                    <a href="{{ attachment.file.url }}" target="_blank">
                        {{ attachment.file.name|slice:"50:" }}{% if attachment.file.name|length > 50 %}...{% endif %}
                    </a>
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>

