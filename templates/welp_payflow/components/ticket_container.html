{% load payflow_tags %}
{% load ticket_message_tags %}

<details class="ticket-container" open>
    <summary class="ticket-header">
        <div class="ticket-title">
            <i class="ticket-caret"></i>
            {{ ticket.title }}
        </div>
        <div class="ticket-info">
            {% ticket_summary_info ticket %}
            <span class="ticket-tag ticket-tag--udn">{{ ticket.udn.name }}</span>
            <span class="ticket-tag ticket-tag--sector">{{ ticket.sector.name }}</span>
            <span class="ticket-tag ticket-tag--category">{{ ticket.accounting_category.name }}</span>

            {% with status_info=ticket|ticket_status_flow %}
                <span class="ticket-status ticket-status--{{ status_info.status }}">
                    <i class="{{ status_info.icon }} mr-1"></i>
                    {{ status_info.label }}
                </span>
            {% endwith %}
        </div>
    </summary>
    <div class="ticket-details">
        {% for message in ticket.messages.all %}
            {% ticket_message message %}
        {% endfor %}
        <div class="ticket-actions">
            {% ticket_actions ticket %}
        </div>
    </div>
</details>