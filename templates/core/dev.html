{% extends "core/base.html" %}

{% block title %}Dev - Welp App{% endblock %}

{% block content %}
<section>
    <div class="dev-nav-container">
        <div class="dev-nav-item">
            <button 
                data-content="content-udns"
                data-url="{% url 'core:dev_udns' %}"
                class="dev-nav-button"
                onclick="toggleContent(this)">
                <div class="dev-nav-icon">
                    <i class="fa fa-map-marker-alt"></i>
                </div>
                <div class="dev-nav-content">
                    <div class="dev-nav-title">UDNs</div>
                    <div class="dev-nav-description">Ubicaciones y centros de operación</div>
                </div>
            </button>
            <div id="content-udns" class="dev-content-container hidden">
                <div class="dev-content-area"></div>
            </div>
        </div>

        <div class="dev-nav-item">
            <button 
                data-content="content-sectors"
                data-url="{% url 'core:dev_sectors' %}"
                class="dev-nav-button"
                onclick="toggleContent(this)">
                <div class="dev-nav-icon">
                    <i class="fa fa-building"></i>
                </div>
                <div class="dev-nav-content">
                    <div class="dev-nav-title">Sectores</div>
                    <div class="dev-nav-description">Áreas funcionales por ubicación</div>
                </div>
            </button>
            <div id="content-sectors" class="dev-content-container hidden">
                <div class="dev-content-area"></div>
            </div>
        </div>

        <div class="dev-nav-item">
            <button 
                data-content="content-desk-categories"
                data-url="{% url 'core:dev_desk_categories' %}"
                class="dev-nav-button"
                onclick="toggleContent(this)">
                <div class="dev-nav-icon">
                    <i class="fa fa-wrench"></i>
                </div>
                <div class="dev-nav-content">
                    <div class="dev-nav-title">Categorías Welp Desk</div>
                    <div class="dev-nav-description">Tipos de incidencias y soporte técnico</div>
                </div>
            </button>
            <div id="content-desk-categories" class="dev-content-container hidden">
                <div class="dev-content-area"></div>
            </div>
        </div>

        <div class="dev-nav-item">
            <button 
                data-content="content-payflow-categories"
                data-url="{% url 'core:dev_payflow_categories' %}"
                class="dev-nav-button"
                onclick="toggleContent(this)">
                <div class="dev-nav-icon">
                    <i class="fa fa-calculator"></i>
                </div>
                <div class="dev-nav-content">
                    <div class="dev-nav-title">Categorías Welp Payflow</div>
                    <div class="dev-nav-description">Categorías contables y presupuestarias</div>
                </div>
            </button>
            <div id="content-payflow-categories" class="dev-content-container hidden">
                <div class="dev-content-area"></div>
            </div>
        </div>

        <div class="dev-nav-item">
            <button 
                data-content="content-hierarchy"
                data-url="{% url 'core:dev_hierarchy' %}"
                class="dev-nav-button"
                onclick="toggleContent(this)">
                <div class="dev-nav-icon">
                    <i class="fa fa-sitemap"></i>
                </div>
                <div class="dev-nav-content">
                    <div class="dev-nav-title">Jerarquía</div>
                    <div class="dev-nav-description">Estructura organizacional del sistema</div>
                </div>
            </button>
            <div id="content-hierarchy" class="dev-content-container hidden">
                <div class="dev-content-area"></div>
            </div>
        </div>

        <div class="dev-nav-item">
            <button 
                data-content="content-purchase-workflow"
                data-url="{% url 'core:dev_purchase_workflow' %}"
                class="dev-nav-button"
                onclick="toggleContent(this)">
                <div class="dev-nav-icon">
                    <i class="fa fa-shopping-cart"></i>
                </div>
                <div class="dev-nav-content">
                    <div class="dev-nav-title">Workflow de Compras</div>
                    <div class="dev-nav-description">Proceso completo de adquisiciones</div>
                </div>
            </button>
            <div id="content-purchase-workflow" class="dev-content-container hidden">
                <div class="dev-content-area"></div>
            </div>
        </div>
    </div>
</section>

<script>
async function toggleContent(button){
  const targetId=button.dataset.content;
  const container=document.getElementById(targetId);
  const area=container.querySelector('.dev-content-area');
  const url=button.dataset.url;
  const isVisible=!container.classList.contains('hidden');
  if(isVisible){
    button.classList.remove('active');
    container.classList.add('hidden');
    container.classList.remove('expanded');
    return;
  }
  // hide others
  document.querySelectorAll('.dev-nav-button.active').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.dev-content-container.expanded').forEach(c=>{c.classList.add('hidden');c.classList.remove('expanded');});
  // show current
  button.classList.add('active');
  container.classList.remove('hidden');
  container.classList.add('expanded');
  if(!area.innerHTML.trim()){
     try{
       const res=await fetch(url);
       area.innerHTML=await res.text();
     }catch(e){
       area.innerHTML='<div class="text-red-500 text-center py-8">Error al cargar el contenido</div>';
     }
  }
}
</script>
{% endblock %} 