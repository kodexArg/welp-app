{% extends 'core/base.html' %}
{% load component_tags %}

{% block title %}dj-apprunner-template - Panel de Control{% endblock %}

{% block content %}
{# {% component "core_test_component" message="Componente de test Django OK" status="success" / %} #}
<div style="max-width: 80rem; margin: 0 auto; padding: 1rem; display: flex; flex-direction: column; gap: 1.5rem; font-family: var(--font-ui); font-size: 0.875rem;" class="animate-fade-in">
    <!-- Header minimalista -->
    <div style="text-align: center; margin-bottom: 2rem;" class="animate-slide-in-top">
        <h1 style="font-size: 1.5rem; font-weight: 300; color: var(--color-sky-700); margin-bottom: 0.5rem; font-family: var(--font-title);">dj-apprunner-template</h1>
        <p style="color: var(--color-sky-500); font-size: 0.75rem;">
            Template para proyectos Django en AWS App Runner
        </p>
        <!-- BotÃ³n de Acceso -->
        <div style="margin-top: 1rem;" class="animate-fade-in animate-delay-200">
            {% if user.is_authenticated %}
                <div style="display: flex; align-items: center; justify-content: center; gap: 1rem;">
                    <span style="font-size: 0.875rem; color: var(--color-sky-600);">Â¡Hola, {{ user.get_full_name|default:user.username }}!</span>
                    <a href="{% url 'core:dashboard' %}" class="button-primary transition-all hover-lift">
                        Dashboard
                    </a>
                    {% if user.is_staff %}
                        <a href="{% url 'admin:index' %}" class="button-success transition-all hover-lift">
                            Admin
                        </a>
                    {% endif %}
                    <a href="{% url 'core:logout' %}" class="button-cancel transition-all hover-lift">
                        Salir
                    </a>
                </div>
            {% else %}
                <div style="display: flex; align-items: center; justify-content: center; gap: 1rem;">
                    <a href="{% url 'core:login' %}" class="button-primary transition-all hover-lift">
                        Acceso
                    </a>
                    <a href="{% url 'admin:index' %}" class="button-success transition-all hover-lift">
                        Admin
                    </a>
                </div>
            {% endif %}
        </div>
    </div>

    <!-- Aplicaciones Disponibles -->
    <div class="card animate-slide-in-left animate-delay-300" style="margin-bottom: 1.5rem;">
        <div class="card-header">
            <h2 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0; font-family: var(--font-ui);">Aplicaciones Disponibles</h2>
        </div>
        <div class="card-body">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem;">
                <a href="{% url 'welp_desk:home' %}" class="hover-lift transition-all" style="display: block; padding: 1rem; border: 2px solid var(--color-sky-200); border-radius: 0.5rem; text-decoration: none; background-color: var(--color-sky-50); transition: all 0.2s ease;">
                    <div style="display: flex; align-items: center;">
                        <div style="width: 0.75rem; height: 0.75rem; background-color: var(--color-sky-500); border-radius: 50%; margin-right: 0.75rem;"></div>
                        <div>
                            <h3 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-600); margin: 0; font-family: var(--font-ui);">Welp Desk</h3>
                            <p style="font-size: 0.75rem; color: var(--color-sky-500); margin: 0; font-family: var(--font-p);">Mesa de Ayuda y Soporte TÃ©cnico</p>
                        </div>
                    </div>
                </a>
                <a href="{% url 'welp_pay:home' %}" class="hover-lift transition-all" style="display: block; padding: 1rem; border: 2px solid var(--color-earth-200); border-radius: 0.5rem; text-decoration: none; background-color: var(--color-earth-50); transition: all 0.2s ease;">
                    <div style="display: flex; align-items: center;">
                        <div style="width: 0.75rem; height: 0.75rem; background-color: var(--color-earth-500); border-radius: 50%; margin-right: 0.75rem;"></div>
                        <div>
                            <h3 style="font-size: 0.875rem; font-weight: 500; color: var(--color-earth-600); margin: 0; font-family: var(--font-ui);">Welp Pay</h3>
                            <p style="font-size: 0.75rem; color: var(--color-earth-500); margin: 0; font-family: var(--font-p);">Sistema de Pagos y FacturaciÃ³n</p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </div>

    <!-- Grid de VerificaciÃ³n TecnolÃ³gica -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 0.75rem; margin-bottom: 1.5rem;" class="animate-slide-in-right animate-delay-500">
        <!-- Vite -->
        <div class="card" style="max-width: 18rem; margin: 0 auto; width: 100%;">
            <div class="card-body" style="padding: 0.75rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                    <h3 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">Vite</h3>
                    <span style="display: flex; align-items: center; justify-content: center; font-size: 0.75rem; border-radius: 50%; background-color: #dcfce7; color: #166534; height: 1.5rem; width: 1.5rem;">âœ…</span>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>HMR:</span>
                        <span id="hmr-status">{{ environment|yesno:"âœ…,ðŸ”„" }}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>Build:</span>
                        <span id="build-status">Verificando...</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tailwind -->
        <div class="card" style="max-width: 18rem; margin: 0 auto; width: 100%;">
            <div class="card-body" style="padding: 0.75rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                    <h3 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">Tailwind</h3>
                    <span style="display: flex; align-items: center; justify-content: center; font-size: 0.75rem; border-radius: 50%; background-color: #dcfce7; color: #166534; height: 1.5rem; width: 1.5rem;">âœ…</span>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>VersiÃ³n:</span>
                        <span>v4</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>Estado:</span>
                        <span>Activo</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- HTMX -->
        <div class="card" style="max-width: 18rem; margin: 0 auto; width: 100%;">
            <div class="card-body" style="padding: 0.75rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                    <h3 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">HTMX</h3>
                    <span style="display: flex; align-items: center; justify-content: center; font-size: 0.75rem; border-radius: 50%; background-color: #dcfce7; color: #166534; height: 1.5rem; width: 1.5rem;" id="htmx-status">âœ…</span>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>VersiÃ³n:</span>
                        <span id="htmx-version">v2.0.4</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>Test:</span>
                        <span><a href="#" hx-get="{% url 'core:htmx_demo' %}" hx-target="#htmx-demo-result" hx-swap="outerHTML" class="transition-colors hover-scale-sm" style="font-size: 0.75rem; color: var(--color-sky-600);">Probar â†’</a></span>
                    </div>
                </div>
                <div id="htmx-demo-result" style="color: var(--color-sky-400);"></div>
            </div>
        </div>

        <!-- Django Components -->
        <div class="card" style="max-width: 18rem; margin: 0 auto; width: 100%;">
            <div class="card-body" style="padding: 0.75rem;">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                    <h3 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">Components</h3>
                    <span style="display: flex; align-items: center; justify-content: center; font-size: 0.75rem; border-radius: 50%; background-color: #dcfce7; color: #166534; height: 1.5rem; width: 1.5rem;">âœ…</span>
                </div>
                <div style="display: flex; flex-direction: column; gap: 0.25rem;">
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>Ping:</span>
                        <span>{% component "ping" ping="test_ping" / %}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--color-sky-500);">
                        <span>Estado:</span>
                        <span>Activo</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Links de Prueba -->
    <div class="card animate-slide-in-bottom animate-delay-700" style="margin-bottom: 1.5rem;">
        <div class="card-header">
            <h2 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">Pruebas Disponibles</h2>
        </div>
        <div class="card-body">
            <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
                <a href="#" hx-get="{% url 'core:health' %}" hx-target="#test-health-result" hx-swap="outerHTML" class="transition-colors hover-scale-sm" style="font-size: 0.75rem; color: var(--color-sky-600);">Health Check</a>
                <span style="color: var(--color-sky-300);">|</span>
                <a href="#" hx-get="{% url 'core:db_health_check' %}" hx-target="#test-db-result" hx-swap="outerHTML" class="transition-colors hover-scale-sm" style="font-size: 0.75rem; color: var(--color-sky-600);">DB Health</a>
                <span style="color: var(--color-sky-300);">|</span>
                <a href="#" hx-get="{% url 'core:hello_world' %}" hx-target="#test-hello-result" hx-swap="outerHTML" class="transition-colors hover-scale-sm" style="font-size: 0.75rem; color: var(--color-sky-600);">Hello World</a>
            </div>
            <div id="test-health-result" style="margin-top: 0.5rem;"></div>
            <div id="test-db-result" style="margin-top: 0.5rem;"></div>
            <div id="test-hello-result" style="margin-top: 0.5rem;"></div>
        </div>
    </div>

    <!-- Tests -->
    <div class="card animate-fade-in-slow animate-delay-1000" style="margin-bottom: 1.5rem;">
        <div class="card-header">
            <h2 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">Tests</h2>
        </div>
        <div class="card-body">
            <details style="font-size: 0.75rem;">
                <summary class="transition-colors hover-scale-sm" style="cursor: pointer; color: var(--color-sky-600);">Ver Tests</summary>
                <pre style="margin-top: 0.5rem; padding: 0.5rem; background-color: var(--color-sky-50); border-radius: 0.25rem; color: var(--color-sky-600); overflow-x: auto; font-family: var(--font-mono);">
1. ConfiguraciÃ³n (tests/test_config.py)
   â”œâ”€â”€ test_secret_key
   â”œâ”€â”€ test_database_config
   â”œâ”€â”€ test_aws_config
   â”œâ”€â”€ test_security_settings
   â”œâ”€â”€ test_installed_apps
   â””â”€â”€ test_middleware

2. Modelos (core/tests/test_models.py)
   â”œâ”€â”€ test_create_user
   â”œâ”€â”€ test_create_superuser
   â””â”€â”€ test_user_str_representation

3. Vistas (core/tests/test_views.py)
   â”œâ”€â”€ test_hello_world
   â”œâ”€â”€ test_health_check
   â”œâ”€â”€ test_db_health_check_success
   â””â”€â”€ test_db_health_check_failure

4. IntegraciÃ³n (tests/test_startup.py)
   â”œâ”€â”€ test_environment_configuration
   â”œâ”€â”€ test_database_integration
   â”œâ”€â”€ test_aws_integration
   â””â”€â”€ test_security_integration</pre>
            </details>
        </div>
    </div>

    <!-- README -->
    <div class="card animate-slide-in-bottom animate-delay-1000">
        <div class="card-header">
            <h2 style="font-size: 0.875rem; font-weight: 500; color: var(--color-sky-700); margin: 0;">DocumentaciÃ³n</h2>
        </div>
        <div class="card-body" style="color: var(--color-sky-600);">
            <h3 style="font-size: 0.75rem; font-weight: 500; color: var(--color-sky-700); margin-bottom: 0.5rem;">Stack TecnolÃ³gico</h3>
            <table style="width: 100%; font-size: 0.75rem;">
                <tr>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">Framework</td>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">Django</td>
                </tr>
                <tr>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">Frontend</td>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">Vite + HTMX + Tailwind</td>
                </tr>
                <tr>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">Base de Datos</td>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">PostgreSQL</td>
                </tr>
                <tr>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">Cloud</td>
                    <td style="padding: 0.25rem 0; border-bottom: 1px solid var(--color-sky-100);">AWS App Runner</td>
                </tr>
                <tr>
                    <td style="padding: 0.25rem 0;">Almacenamiento</td>
                    <td style="padding: 0.25rem 0;">S3 + CloudFront</td>
                </tr>
            </table>

            <h3 style="font-size: 0.75rem; font-weight: 500; color: var(--color-sky-700); margin: 1rem 0 0.5rem 0;">CaracterÃ­sticas de la AplicaciÃ³n</h3>
            
            <h4 style="font-size: 0.75rem; font-weight: 500; color: var(--color-earth-600); margin: 0.75rem 0 0.25rem 0;">ðŸ“‹ Welp Desk - Mesa de Ayuda</h4>
            <ul style="font-size: 0.75rem; margin: 0; padding-left: 1.25rem;">
                <li>âœ… GestiÃ³n de tickets de soporte</li>
                <li>âœ… Sistema de categorizaciÃ³n y prioridades</li>
                <li>âœ… AsignaciÃ³n de tÃ©cnicos</li>
                <li>âœ… Seguimiento de estado</li>
                <li>âœ… Reportes de actividad</li>
            </ul>

            <h4 style="font-size: 0.75rem; font-weight: 500; color: var(--color-earth-600); margin: 0.75rem 0 0.25rem 0;">ðŸ’³ Welp Pay - Sistema de Pagos</h4>
            <ul style="font-size: 0.75rem; margin: 0; padding-left: 1.25rem;">
                <li>âœ… Procesamiento de pagos</li>
                <li>âœ… FacturaciÃ³n automÃ¡tica</li>
                <li>âœ… GestiÃ³n de suscripciones</li>
                <li>âœ… Reportes financieros</li>
                <li>âœ… IntegraciÃ³n con pasarelas de pago</li>
            </ul>

            <h3 style="font-size: 0.75rem; font-weight: 500; color: var(--color-sky-700); margin: 1rem 0 0.5rem 0;">IntegraciÃ³n con Servicios AWS</h3>
            <ul style="font-size: 0.75rem; margin: 0; padding-left: 1.25rem;">
                <li>âœ… <strong>S3</strong>: Almacenamiento de archivos estÃ¡ticos y media</li>
                <li>âœ… <strong>CloudFront</strong>: CDN para distribuciÃ³n global</li>
                <li>âœ… <strong>App Runner</strong>: Despliegue automÃ¡tico y escalado</li>
                <li>âœ… <strong>RDS PostgreSQL</strong>: Base de datos gestionada</li>
                <li>âœ… <strong>IAM</strong>: GestiÃ³n de permisos y accesos</li>
            </ul>

            <h3 style="font-size: 0.75rem; font-weight: 500; color: var(--color-sky-700); margin: 1rem 0 0.5rem 0;">Notas</h3>
            <ul style="font-size: 0.75rem; margin: 0; padding-left: 1.25rem;">
                <li>ðŸš€ <strong>Despliegue automÃ¡tico</strong>: Push a <code>main</code> â†’ Deploy automÃ¡tico</li>
                <li>ðŸ”’ <strong>Seguridad</strong>: HTTPS, CSRF protection, configuraciÃ³n segura</li>
                <li>ðŸ“Š <strong>Monitoreo</strong>: Health checks y logs integrados</li>
                <li>ðŸŽ¨ <strong>UI/UX</strong>: Sistema de diseÃ±o personalizado con Tailwind</li>
                <li>âš¡ <strong>Performance</strong>: Vite HMR + HTMX para experiencia rÃ¡pida</li>
                <li>ðŸ§ª <strong>Testing</strong>: Suite completa de tests automatizados</li>
            </ul>

            <div style="margin-top: 1rem; padding: 0.75rem; background-color: var(--color-sky-50); border-radius: 0.25rem;">
                <p style="margin: 0; font-size: 0.75rem; color: var(--color-sky-600);">
                    <strong>Licencia:</strong> Proyecto privado para ALVS Group. Todos los derechos reservados.
                </p>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript para verificaciÃ³n de estado -->
<script>
    // Verificar estado de build
    document.addEventListener('DOMContentLoaded', function() {
        const buildStatus = document.getElementById('build-status');
        if (buildStatus) {
            // Simular verificaciÃ³n de build (en producciÃ³n serÃ­a una llamada real)
            setTimeout(() => {
                buildStatus.textContent = 'âœ…';
            }, 1000);
        }
    });

    // Listener para HTMX
    document.addEventListener('htmx:loaded', function(event) {
        const htmxVersion = document.getElementById('htmx-version');
        if (htmxVersion && event.detail.version) {
            htmxVersion.textContent = `v${event.detail.version}`;
        }
    });
</script>
{% endblock %} 